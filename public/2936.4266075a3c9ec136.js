"use strict";(self.webpackChunkvex=self.webpackChunkvex||[]).push([[2936],{91249:(B,I,o)=>{o.d(I,{K:()=>b});var d=o(69862),_=o(20553),S=o(58504),T=o(26306),x=o(65879),i=o(80154);let b=(()=>{class f{constructor(c,s){this.http=c,this.tokenService=s,this._url=`${_.N.API_URL}/SerieFactura/`,this.estado=1}setSerieFactura(c){const s=new d.WM({"Content-Type":"application/json"});return this.http.post(this._url+"SetSerie",JSON.stringify(c),{headers:s}).pipe((0,T.K)(p=>(console.error(p),(0,S._)({ok:!1,estado:"401",mensaje:"Sin Autorizacion"}))))}putSerieFactura(c){const s=new d.WM({"Content-Type":"application/json"});return this.http.post(this._url+"PutSerie",JSON.stringify(c),{headers:s}).pipe((0,T.K)(p=>(console.error(p),(0,S._)({ok:!1,estado:"401",mensaje:"Sin Autorizacion"}))))}CambiarEstadoSerie(c,s,p){const g=new d.WM({"Content-Type":"application/json"});return this.http.post(`${this._url}CambiarEstadoSerie?IdSerie=${c}&IdUM=${s}&razon=${p}`,g)}getSerieFactura(c){return this.http.get(`${this._url}GetSerie`,{params:{searchTerm:c}})}getSerieFacturaById(c){return this.http.get(`${this._url}GetSerieById?IdS=${c}`)}getSerieFacturaBySL(c){return this.http.get(`${this._url}GetSerieBySL?IdSL=${c}`)}static#t=this.\u0275fac=function(s){return new(s||f)(x.LFG(d.eN),x.LFG(i.B))};static#e=this.\u0275prov=x.Yz7({token:f,factory:f.\u0275fac,providedIn:"root"})}return f})()},42936:(B,I,o)=>{o.r(I),o.d(I,{VentaTableModule:()=>mt});var d=o(96814),_=o(29522),S=o(33594),T=o(62008),x=o(95982),i=o(56223),b=o(83620),f=o(86820),J=o(64435),c=o(65619),s=o(96726),p=o(27921),g=o(94664),h=o(37398),t=o(65879),v=o(19347),D=o(11333),U=o(22939),E=o(71996),L=o(91249),A=o(32296),F=o(30617),P=o(24516),Z=o(41043),M=o(26385),N=o(98525),y=o(23680);function Q(n,l){if(1&n&&(t.TgZ(0,"mat-option",30)(1,"div",31),t._UZ(2,"img",32),t.TgZ(3,"span",33),t._uU(4),t.qZA()()()),2&n){const e=l.$implicit;t.Q6J("value",e.Id),t.xp6(2),t.Q6J("src",e.Url_IMG,t.LSH),t.xp6(2),t.Oqu(e.name)}}function R(n,l){if(1&n&&(t.TgZ(0,"mat-option",30)(1,"div",31),t._UZ(2,"img",32),t.TgZ(3,"span",33),t._uU(4),t.qZA()()()),2&n){const e=l.$implicit;t.Q6J("value",e.Id),t.xp6(2),t.Q6J("src",e.Url_IMG,t.LSH),t.xp6(2),t.Oqu(e.name)}}function G(n,l){if(1&n&&(t.TgZ(0,"mat-option",30),t._uU(1),t.qZA()),2&n){const e=l.$implicit;t.Q6J("value",e.c_Id_Serie),t.xp6(1),t.Oqu(e.c_Nombre)}}function Y(n,l){1&n&&(t.TgZ(0,"mat-error"),t._uU(1,"Este campo es requerido."),t.qZA())}function $(n,l){1&n&&(t.TgZ(0,"mat-error"),t._uU(1,"Solo se permiten letras y n\xfameros."),t.qZA())}function j(n,l){1&n&&(t.TgZ(0,"mat-error"),t._uU(1,"Debe tener al menos 4 caracteres."),t.qZA())}function z(n,l){if(1&n){const e=t.EpF();t.TgZ(0,"div",34)(1,"div",35)(2,"div",36)(3,"div",37)(4,"div",38)(5,"div",7)(6,"div",39)(7,"div",40)(8,"div",41),t._UZ(9,"img",42),t.qZA()(),t.TgZ(10,"div",43)(11,"label",44)(12,"span"),t._uU(13,"Subir Imagen"),t.qZA()(),t.TgZ(14,"input",45),t.NdJ("change",function(r){const u=t.CHM(e).index,C=t.oxw();return t.KtG(C.onFileSelected(r,u))}),t.qZA()()()()(),t.TgZ(15,"div",38)(16,"div",13)(17,"div",27)(18,"mat-form-field",13)(19,"mat-label",46),t._uU(20,"Nombre"),t.qZA(),t._UZ(21,"input",47)(22,"mat-icon",48),t.YNc(23,Y,2,0,"mat-error",28),t.YNc(24,$,2,0,"mat-error",28),t.YNc(25,j,2,0,"mat-error",28),t.qZA()(),t.TgZ(26,"div",27)(27,"mat-form-field",13)(28,"mat-label",46),t._uU(29,"Stock"),t.qZA(),t._UZ(30,"input",49)(31,"mat-icon",50),t.qZA(),t.TgZ(32,"mat-form-field",13)(33,"mat-label",46),t._uU(34,"Precio de Compra"),t.qZA(),t._UZ(35,"input",51)(36,"mat-icon",50),t.qZA(),t.TgZ(37,"mat-form-field",13)(38,"mat-label",46),t._uU(39,"IVA"),t.qZA(),t._UZ(40,"input",52)(41,"mat-icon",50),t.qZA(),t.TgZ(42,"mat-form-field",13)(43,"mat-label",46),t._uU(44,"IVA"),t.qZA(),t._UZ(45,"input",53)(46,"mat-icon",50),t.qZA(),t.TgZ(47,"mat-form-field",13)(48,"mat-label",46),t._uU(49,"IVA"),t.qZA(),t._UZ(50,"input",54)(51,"mat-icon",50),t.qZA()()(),t.TgZ(52,"div")(53,"button",55),t.NdJ("click",function(){const m=t.CHM(e).index,u=t.oxw();return t.KtG(u.removerCampo(m))}),t._uU(54,"Remover"),t.qZA()()()()()()()}if(2&n){const e=l.$implicit,a=l.index,r=t.oxw();t.xp6(1),t.Q6J("formGroupName",a),t.xp6(8),t.Q6J("src",r.urlsImagenes[a]||r.imagenPorDefectoURL,t.LSH),t.xp6(2),t.MGl("for","image-upload-",a,""),t.xp6(3),t.MGl("id","image-upload-",a,""),t.xp6(5),t.uIk("for","c_Nombre_Producto"+a),t.xp6(2),t.uIk("id","c_Nombre_Producto"+a),t.xp6(2),t.Q6J("ngIf",e.get("c_Nombre_Producto").hasError("required")),t.xp6(1),t.Q6J("ngIf",e.get("c_Nombre_Producto").hasError("pattern")),t.xp6(1),t.Q6J("ngIf",e.get("c_Nombre_Producto").hasError("minlength")),t.xp6(3),t.uIk("for","c_Cantidad"+a),t.xp6(2),t.uIk("id","c_Cantidad"+a),t.xp6(3),t.uIk("for","c_Precio_Venta"+a),t.xp6(2),t.uIk("id","c_Precio_Venta"+a),t.xp6(3),t.uIk("for","c_IVA"+a),t.xp6(2),t.uIk("id","c_IVA"+a),t.xp6(3),t.uIk("for","c_SubTotal"+a),t.xp6(2),t.uIk("id","c_SubTotal"+a),t.xp6(3),t.uIk("for","c_Total"+a),t.xp6(2),t.uIk("id","c_Total"+a)}}function K(n,l){if(1&n&&(t.ynx(0),t.TgZ(1,"button",56),t._uU(2,"Cancel"),t.qZA(),t.TgZ(3,"button",57),t._uU(4," Registrar Marca"),t.qZA(),t._UZ(5,"button",58),t.BQk()),2&n){const e=t.oxw();t.xp6(3),t.Q6J("disabled",!e.registerForm.valid)}}function W(n,l){if(1&n&&(t.ynx(0),t._UZ(1,"span",59),t.TgZ(2,"button",60),t._uU(3,"Cancel"),t.qZA(),t.TgZ(4,"button",57),t._uU(5," Registrar Marca"),t.qZA(),t.BQk()),2&n){const e=t.oxw();t.xp6(2),t.Q6J("disabled",e.registerForm.valid),t.xp6(2),t.Q6J("disabled",e.registerForm.valid)}}const w=function(n){return{"margin-top":n}},H=[{path:"",component:(()=>{class n{onResizae(e){this.applyMarginBottom=window.innerWidth<768,this.applyMarginTop=window.innerWidth>=768}constructor(e,a,r,m,u,C,O,dt,ut,pt,gt){this.dialog=e,this.ProductoService=a,this.snackBar=r,this.router=m,this.renderer=u,this.fb=C,this.ngZone=O,this.CS=dt,this.cdr=ut,this.SerieFacturaService=pt,this.FormBuilder=gt,this.Data=[],this.tablaDataSubject=new c.X([]),this.tablaData$=this.tablaDataSubject.asObservable(),this.imagen="",this.MarcaCtrl=new i.NI,this.searchCtrl=new i.p4,this.FacturacionCtrl=new i.p4,this.ProductosCtrl=new i.p4,this.estado=this.ProductoService.estado,this.Color=["font-medium"],this.menuOpen=!1,this.c_Id_Producto=[[1,2],[3,4],[5,6]],this.urlsImagenes=[],this.selectedImage=null,this.selectedImageURL="https://img.srvcentral.com/Sistema/ImagenPorDefecto/Servicios.jpg",this.imagenPorDefectoURL="https://img.srvcentral.com/Sistema/ImagenPorDefecto/Servicios.jpg",this.valido=!0,this.searchStr$=this.searchCtrl.valueChanges.pipe((0,b.b)(10)),this.activeCategory="Activo",this.tableData=this.Data,this.tableColumns=[{label:"",property:"c_Url_IMG",type:"image",cssClasses:["h-9 rounded-full"]},{label:"Descripcion",property:"c_Nombre",type:"text",cssClasses:["font-medium"]},{label:"Cantidad",property:"c_Cantidad",type:"text",cssClasses:["font-medium"]},{label:"Precio",property:"c_Precio",type:"text",cssClasses:["font-medium"]},{label:"IVA",property:"c_IVA",type:"text",cssClasses:["font-medium"]},{label:"Total",property:"c_Total",type:"text",cssClasses:["font-medium"]}],this.applyMarginBottom=!1,this.applyMarginTop=!1,this.registerForm=this.FormBuilder.group({campo:this.FormBuilder.array([])});const ht=localStorage.getItem("token"),V=(0,s.Z)(ht),vt=V.IdSucursal;this.c_Id_Usuario=V.IdUsuario,this.Id_Sucursal=vt,this.agregarCampo()}ngOnInit(){this.checkScreenSize(),this.usuarioForm=this.fb.group({c_Id_Persona:[],c_Id_Producto:[[0]],c_Id_Sucursal:[],c_Id_Serie:[],c_NIT:[],c_Direccion:[],c_Img_Base:["0"],c_Fecha_Nacimiento:["",i.kI.required],c_Usuario_Creacion:[""]}),this.usuarioForm.patchValue({c_Usuario_Creacion:this.c_Id_Usuario,c_Id_Sucursal:this.Id_Sucursal}),this.filteredFacturacion$=this.FacturacionCtrl.valueChanges.pipe((0,p.O)(""),(0,g.w)(e=>this.CS.getPersonaFacturacion(e)),(0,h.U)(e=>e.slice())),this.filteredProductos$=this.ProductosCtrl.valueChanges.pipe((0,p.O)(""),(0,g.w)(e=>this.ProductoService.getProductoFacturacion(this.Id_Sucursal)),(0,h.U)(e=>e.slice())),this.usuarioForm.get("c_Id_Persona").valueChanges.subscribe(e=>{this.BuscarCliente(e)}),this.SerieFacturaService.getSerieFacturaBySL(this.Id_Sucursal).subscribe(e=>{this.Serie=e.response,this.Serie.length>0&&this.usuarioForm.patchValue({c_Id_Serie:this.Serie[0].c_Id_Serie})})}get Servicio(){return this.registerForm.get("campo")}agregarCampo(){this.FormBuilder.group({c_Img_Base:"0",c_Nombre_Producto:["",[i.kI.required,i.kI.pattern(/^[a-zA-Z0-9]*$/),i.kI.minLength(4),i.kI.maxLength(24)]],c_Cantidad:[""],c_Precio_Venta:[""],c_IVA:[""],c_SubTotal:[""],c_Total:[""],c_Id_Sucursal:this.Id_Sucursal,c_Usuario_Creacion:this.c_Id_Usuario})}removerCampo(e){this.Servicio.removeAt(e),this.urlsImagenes.splice(e,1),this.form.get("c_Img_Base")?.setValue("")}onFileSelecteds(e){const a=e.target;a?.files?.length&&(this.selectedImage=a.files[0],this.loadImages())}loadImages(){if(this.selectedImage){const e=new FileReader;e.onload=()=>{this.ngZone.run(()=>{this.selectedImageURL=e.result;const r=this.selectedImageURL.split(",");this.imagen=r[1],this.ngZone.run(()=>{this.form.get("c_Img_Base")?.setValue(this.imagen)}),this.cdr.detectChanges()})},e.readAsDataURL(this.selectedImage)}}onFileSelected(e,a){const r=e.target;r?.files?.length&&this.loadImage(r.files[0],a)}loadImage(e,a){if(e){const r=new FileReader;r.onload=()=>{this.ngZone.run(()=>{const m=r.result;this.urlsImagenes[a]=m;const C=m.split(",");this.imagen=C[1],this.Servicio.at(a).get("c_Img_Base")?.setValue(this.imagen),this.cdr.detectChanges()})},r.readAsDataURL(e)}}setFilter(e){this.activeCategory=e}isActive(e){return this.activeCategory===e}BuscarCliente(e){this.CS.getPersonaFacturacionById(e).subscribe(a=>{this.persona=a,console.log(this.persona),this.usuarioForm.patchValue({c_NIT:a.response.c_NIT,c_Direccion:a.response.c_Direccion}),this.cdr.detectChanges()},a=>{console.error("Error fetching employee data:",a)})}openContact(e){this.dialog.open(J.a,{data:e||null,width:"65rem"})}setData(e){this.menuOpen=!1}openMenu(){this.menuOpen=!0}onResize(e){this.checkScreenSize()}checkScreenSize(){window.innerWidth<768&&this.router.navigate(["/apps/producto/grid/activos"])}static#t=this.\u0275fac=function(a){return new(a||n)(t.Y36(v.uw),t.Y36(D.U),t.Y36(U.ux),t.Y36(_.F0),t.Y36(t.Qsj),t.Y36(i.QS),t.Y36(t.R0b),t.Y36(E.x),t.Y36(t.sBO),t.Y36(L.K),t.Y36(i.qu))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["vex-contacts-table"]],hostBindings:function(a,r){1&a&&t.NdJ("resize",function(u){return r.onResize(u)},!1,t.Jf7)},decls:49,vars:18,consts:[[1,"w-full","h-full","flex","flex-col"],[1,"px-gutter","pt-6","pb-20","bg-primary/10","flex-none"],[1,"p-gutter","container"],[1,"flex","flex-col","sm:flex-row","gap-4",3,"formGroup"],[1,"card","flex-auto"],[1,"px-6","py-4","borde","r-b","flex","items-center"],[1,"title","m-0"],[1,"px-6","py-4","flex","flex-col"],[1,"flex","flex-col","sm:flex-row","sm:gap-4"],[1,"flex-auto"],["formControlName","c_Id_Persona","placeholder","C/F"],[3,"value",4,"ngFor","ngForOf"],["formControlName","c_Id_Producto","multiple",""],[1,"flex-1","sm:w-1/4"],["formControlName","c_Id_Serie",3,"ngModel","ngModelChange"],[1,"flex","items-center","justify-end","gap-2"],["mat-button","","type","button"],["color","primary","mat-raised-button","","type","button",3,"disabled"],[3,"formGroup"],["mat-dialog-title","",1,"flex","items-center"],[1,"headline","m-0","flex-auto"],[1,"text-border"],[1,"flex","flex-col","mat-form-field"],["formArrayName","campo",4,"ngFor","ngForOf"],[3,"ngStyle"],["color","primary","mat-flat-button","","mat-button","","type","button",3,"click"],["align","end"],[1,"flex","flex-col","sm:flex-row","sm:gap-7"],[4,"ngIf"],[1,"flex","flex-col","overflow-hidden","sm:flex-row","sm:gap-4"],[3,"value"],[1,"option-container"],[1,"align-middle","mr-4","shadow-lg",2,"width","8%","height","8%",3,"src"],[1,"body-1"],["formArrayName","campo"],[3,"formGroupName"],[1,"form-group","row"],[1,"col-md-3"],[1,"flex","flex-col","sm:flex-row","sm:gap-5"],[1,"image-upload-container"],[1,"selected-image-container"],[1,"selected-image-wrapper"],["alt","Imagen seleccionada",3,"src"],[1,"button-container"],[1,"custom-file-upload",3,"for"],["type","file","accept","image/*",3,"id","change"],[1,"col-md-1"],["type","text","formControlName","c_Nombre_Producto","matInput","",1,"form-control"],["matSuffix","","svgIcon","mat:format_shapes"],["type","text","formControlName","c_Cantidad","matInput","",1,"form-control"],["matSuffix","","svgIcon","mat:dialpad"],["type","text","formControlName","c_Precio_Venta","matInput","",1,"form-control"],["type","text","formControlName","c_IVA","matInput","",1,"form-control"],["type","text","formControlName","c_SubTotal","matInput","",1,"form-control"],["type","text","formControlName","c_Total","matInput","",1,"form-control"],["mat-flat-button","","mat-button","","color","warn",3,"click"],["mat-button","","mat-dialog-close","","type","button"],["color","primary","mat-flat-button","","type","submit",3,"disabled"],["hidden",""],[1,"loader"],["mat-button","","mat-dialog-close","","type","button",3,"disabled"]],template:function(a,r){1&a&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"h2",6),t._uU(7,"Formulario de Facturacion Venta"),t.qZA()(),t._UZ(8,"div",7),t.TgZ(9,"div",7)(10,"div",8)(11,"mat-form-field",9)(12,"mat-label"),t._uU(13,"Seleccione un Cliente"),t.qZA(),t.TgZ(14,"mat-select",10),t.YNc(15,Q,5,3,"mat-option",11),t.ALo(16,"async"),t.qZA()(),t.TgZ(17,"mat-form-field",9)(18,"mat-label"),t._uU(19,"Seleccione un Producto"),t.qZA(),t.TgZ(20,"mat-select",12),t.YNc(21,R,5,3,"mat-option",11),t.ALo(22,"async"),t.qZA()(),t.TgZ(23,"mat-form-field",13)(24,"mat-label"),t._uU(25,"Serie"),t.qZA(),t.TgZ(26,"mat-select",14),t.NdJ("ngModelChange",function(u){return r.SerieSeleccionada=u}),t.YNc(27,G,2,2,"mat-option",11),t.qZA()()(),t.TgZ(28,"div",15)(29,"button",16),t._uU(30,"Cancelar"),t.qZA(),t.TgZ(31,"button",17),t._uU(32,"Guardar"),t.qZA()()()()()(),t.TgZ(33,"form",18)(34,"div",19)(35,"h2",20),t._uU(36,"Registrar Servicio"),t.qZA()(),t._UZ(37,"mat-divider",21),t.TgZ(38,"mat-dialog-content",22),t.YNc(39,z,55,19,"div",23),t.TgZ(40,"div",24)(41,"button",25),t.NdJ("click",function(){return r.agregarCampo()}),t._uU(42,"A\xf1adir M\xe1s"),t.qZA()()(),t.TgZ(43,"mat-dialog-actions",26)(44,"div",27)(45,"div",13),t.YNc(46,K,6,1,"ng-container",28),t.YNc(47,W,6,2,"ng-container",28),t.qZA()()()(),t._UZ(48,"div",29),t.qZA()()),2&a&&(t.xp6(2),t.Q6J("@stagger",!0),t.xp6(1),t.Q6J("formGroup",r.usuarioForm),t.xp6(12),t.Q6J("ngForOf",t.lcZ(16,12,r.filteredFacturacion$)),t.xp6(6),t.Q6J("ngForOf",t.lcZ(22,14,r.filteredProductos$)),t.xp6(5),t.Q6J("ngModel",r.SerieSeleccionada),t.xp6(1),t.Q6J("ngForOf",r.Serie),t.xp6(4),t.Q6J("disabled",!r.usuarioForm.valid),t.xp6(2),t.Q6J("formGroup",r.registerForm),t.xp6(6),t.Q6J("ngForOf",r.Servicio.controls),t.xp6(1),t.Q6J("ngStyle",t.VKq(16,w,r.applyMarginBottom?"0":"1.4rem")),t.xp6(6),t.Q6J("ngIf",r.valido),t.xp6(1),t.Q6J("ngIf",!r.valido))},dependencies:[d.sg,d.O5,d.PC,A.lW,F.Hw,v.ZT,v.uh,v.xY,v.H8,i._Y,i.Fj,i.JJ,i.JL,i.sg,i.u,i.x0,i.CE,P.Nt,Z.KE,Z.hX,Z.TO,Z.R9,M.d,N.gD,y.ey,d.Ov],styles:['@charset "UTF-8";table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{padding:8px;border:1px solid #ccc;text-align:left}.cell[_ngcontent-%COMP%]{cursor:pointer;padding:8px;background-color:#f2f2f2}.cell[_ngcontent-%COMP%]:hover{background-color:#e0e0e0}.truncate-text[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:20px}.option-container[_ngcontent-%COMP%]{display:flex;align-items:center}.option-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:15%;margin-right:5px}.option-container[_ngcontent-%COMP%]   .body-2[_ngcontent-%COMP%]{margin:0}',".mat-drawer-container[_ngcontent-%COMP%]{background:transparent!important}"],data:{animation:[f.KF,T.a,x.G]}})}return n})(),data:{scrollDisabled:!0,toolbarShadowEnabled:!0}}];let X=(()=>{class n{static#t=this.\u0275fac=function(a){return new(a||n)};static#e=this.\u0275mod=t.oAB({type:n});static#o=this.\u0275inj=t.cJS({imports:[_.Bz.forChild(H),_.Bz,S.d8]})}return n})();var k=o(25313),q=o(21476),tt=o(13566),et=o(75986),ot=o(77988),at=o(95783),nt=o(15516),rt=o(32651),it=o(498),st=o(82599),ct=o(38034),lt=o(24630);let mt=(()=>{class n{static#t=this.\u0275fac=function(a){return new(a||n)};static#e=this.\u0275mod=t.oAB({type:n});static#o=this.\u0275inj=t.cJS({imports:[d.ez,X,it.ComponentsSlideToggleModule,A.ot,k.p0,q.TU,tt.JX,et.p9,F.Ps,ot.Tx,y.si,v.Is,at.Y,nt.M,i.UX,rt.SJ,U.ZX,st.rP,i.u5,P.c,M.t,ct.FA,y.XK,N.LD,lt.Bb]})}return n})()}}]);